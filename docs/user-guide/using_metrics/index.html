<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Using Metrics - EngineBlock</title>
    <meta name="generator" content="Hugo 0.46" />

    
    <meta name="description" content="EngineBlock Docs">
    
    <link rel="canonical" href="http://docs.engineblock.io/user-guide/using_metrics/">
    

    <meta property="og:url" content="http://docs.engineblock.io/user-guide/using_metrics/">
    <meta property="og:title" content="EngineBlock">
    <meta property="og:image" content="/images/engineblock_128.png">
    <meta name="apple-mobile-web-app-title" content="EngineBlock">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="../../images/engineblock_32.png">
    <link rel="icon" type="image/x-icon" href="../../images/engineblock_32.png">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('/fonts/icon.eot?52m981');
        src: url('/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
             url('/fonts/icon.woff?52m981')
               format('woff'),
             url('/fonts/icon.ttf?52m981')
               format('truetype'),
             url('/fonts/icon.svg?52m981#icon')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="../../stylesheets/application.css">
    <link rel="stylesheet" href="../../stylesheets/temporary.css">
    <link rel="stylesheet" href="../../stylesheets/palettes.css">
    <link rel="stylesheet" href="../../stylesheets/images.css">

    <link rel="stylesheet" href="../../stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,700|Roboto&#43;Mono">
    <style>
      body, input {
        font-family: 'Roboto', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Roboto Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="../../javascripts/modernizr.js"></script>

    

  

    
    

    
    

    
    

    
    
    <script src="http://docs.engineblock.io//modules/jssequence/webfont.js"></script>
    <script src="http://docs.engineblock.io//modules/jssequence/snap.svg-min.js"></script>
    <script src="http://docs.engineblock.io//modules/jssequence/underscore-min.js"></script>
    <script src="http://docs.engineblock.io//modules/jssequence/sequence-diagram.js"></script>
    <link href="http://docs.engineblock.io//modules/jssequence/sequence-diagram-min.css" rel="stylesheet" />
    

    
    
    <script src="http://docs.engineblock.io//modules/railroad/railroad-diagrams.js"></script>
    <link href="http://docs.engineblock.io//modules/railroad/railroad-diagrams.css" rel="stylesheet">
    

    
    
    <link href="http://docs.engineblock.io//modules/jsxgraph/jsxgraph.css" type="text/css" rel="stylesheet"/>
    <script src="http://docs.engineblock.io//modules/jsxgraph//jsxgraphcore.js"></script>
    
    

    
    
    <link href="http://docs.engineblock.io//modules/mermaid/mermaid.css" type="text/css" rel="stylesheet"/>
    <script src="http://docs.engineblock.io//modules/mermaid/mermaid.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    

    
    
    <script src="http://docs.engineblock.io//modules/nomnoml/lodash.min.js"></script>
    <script src="http://docs.engineblock.io//modules/nomnoml/dagre.min.js"></script>
    <script src="http://docs.engineblock.io//modules/nomnoml/skanaar.util.js"></script>
    <script src="http://docs.engineblock.io//modules/nomnoml/skanaar.svg.js"></script>
    <script src="http://docs.engineblock.io//modules/nomnoml/skanaar.vector.js"></script>
    <script src="http://docs.engineblock.io//modules/nomnoml/skanaar.canvas.js"></script>
    <script src="http://docs.engineblock.io//modules/nomnoml/nomnoml.jison.js"></script>
    <script src="http://docs.engineblock.io//modules/nomnoml/nomnoml.parser.js"></script>
    <script src="http://docs.engineblock.io//modules/nomnoml/nomnoml.layouter.js"></script>
    <script src="http://docs.engineblock.io//modules/nomnoml/nomnoml.renderer.js"></script>
    <script src="http://docs.engineblock.io//modules/nomnoml/nomnoml.js"></script>
    

    
    

    
    


  </head>
  <body class="palette-primary-grey palette-accent-teal">




<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Using Metrics
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/engineblock/engineblock" title="@engineblock/engineblock on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="http://docs.engineblock.io/" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="http://docs.engineblock.io/images/engineblock_128.png">
        </div>
      
      <div class="name">
        <strong>EngineBlock </strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="EngineBlock" href="../../">
	
	EngineBlock
</a>





  
</li>



<li>
  
    



<a  title="Quickstart" href="../../quickstart/">
	
	Quickstart
</a>





  
</li>



<li>
  
    <span class="section">User Guide</span>
    <ul>
      
        
        



<a  title="Concepts" href="../../user-guide/concepts/">
	
	Concepts
</a>





      
        
        



<a  title="Command Line" href="../../user-guide/command_line/">
	
	Command Line
</a>





      
        
        



<a  title="CLI Scripting" href="../../user-guide/cli_scripting/">
	
	CLI Scripting
</a>





      
        
        



<a  title="YAML Config" href="../../user-guide/standard_yaml/">
	
	YAML Config
</a>





      
        
        



<a  title="Timing Terms" href="../../user-guide/timing_terms/">
	
	Timing Terms
</a>





      
        
        



<a  title="Using Metrics" href="../../user-guide/using_metrics/">
	
	Using Metrics
</a>





      
        
        



<a  title="Standard Metrics" href="../../user-guide/standard_metrics/">
	
	Standard Metrics
</a>





      
        
        



<a  title="Coordinated Omission" href="../../user-guide/coordinated_omission/">
	
	Coordinated Omission
</a>





      
        
        



<a  title="Scenario Scripting" href="../../user-guide/scenario_scripting/">
	
	Scenario Scripting
</a>





      
    </ul>
  
</li>



<li>
  
    <span class="section">Parameters</span>
    <ul>
      
        
        



<a  title="Parameter Usage" href="../../parameters/parameter_usage/">
	
	Parameter Usage
</a>





      
        
        



<a  title="Example Command" href="../../parameters/example_command/">
	
	Example Command
</a>





      
        
        



<a  title="Activity Params" href="../../parameters/activity_params/">
	
	Activity Params
</a>





      
        
        



<a  title="Statement Params" href="../../parameters/statement_params/">
	
	Statement Params
</a>





      
    </ul>
  
</li>



<li>
  
    <span class="section">Dev Guide</span>
    <ul>
      
        
        



<a  title="Activity Internals" href="../../dev-guide/activity_internals/">
	
	Activity Internals
</a>





      
        
        



<a  title="Async Operations" href="../../dev-guide/async_operations/">
	
	Async Operations
</a>





      
        
        



<a  title="Building ActivityTypes" href="../../dev-guide/building_activities/">
	
	Building ActivityTypes
</a>





      
        
        



<a  title="Contributing" href="../../dev-guide/contributing/">
	
	Contributing
</a>





      
        
        



<a  title="Design Guidelines" href="../../dev-guide/implementors_guide/">
	
	Design Guidelines
</a>





      
        
        



<a  title="Diag ActivityType" href="../../dev-guide/annotated_diag/">
	
	Diag ActivityType
</a>





      
        
        



<a  title="Project Structure" href="../../dev-guide/project_structure/">
	
	Project Structure
</a>





      
        
        



<a  title="Scripting Extensions" href="../../dev-guide/scripting_extensions/">
	
	Scripting Extensions
</a>





      
        
        



<a  title="Error Mapping" href="../../dev-guide/error_mapping/">
	
	Error Mapping
</a>





      
        
        



<a  title="YAML Config API" href="../../dev-guide/standard_yam_devl/">
	
	YAML Config API
</a>





      
    </ul>
  
</li>


        </ul>
        

        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Using Metrics </h1>

			

<h2 id="unit-of-measure">Unit of Measure</h2>

<p>All metrics collected from activities are recorded in nanoseconds and ops per
second. All histograms are recorded with 4 digits of precision using HDR
histograms.</p>

<h2 id="metric-outputs">Metric Outputs</h2>

<p>Metrics from a scenario run can be gathered in multiple ways:</p>

<ul>
<li>In the log output</li>
<li>In CSV files</li>
<li>In HDR histogram logs</li>
<li>In Histogram Stats logs (CSV)</li>
<li>To a monitoring system via graphite</li>
</ul>

<p>These forms may be combined and used in combination. The command line options
for enabling these are documented in the built-in help, although some examples
of these may be found below.</p>

<h2 id="metrics-via-graphite">Metrics via Graphite</h2>

<p>If you like to have all of your testing data in one place, then you may be
interested in reporting your measurements to a monitoring system. For this,
EngineBlock includes a <a href="https://github.com/dropwizard/metrics">Metrics Library</a>.
Graphite reporting is baked in as the default reporter.</p>

<p>In order to enable graphite reporting, use one of these options formats:</p>

<pre><code>    --report-graphite-to &lt;host&gt;
    --report-graphite-to &lt;host&gt;:&lt;port&gt;
</code></pre>

<h2 id="metrics-scripting">Metrics &amp; Scripting</h2>

<p>There are enhancements to the metrics bundled with EngineBlock to support
advanced scripting. See the <a href="../../user-guide/scenario_scripting/#enhanced-metrics-for-scripting">Advanced Metrics for
Scripting</a> in the
scripting guide for more details.</p>

<h2 id="metric-naming">Metric Naming</h2>

<h4 id="prefix-core-metrics-use-the-prefix-engineblock-by-default-you-can">Prefix Core metrics use the prefix <em>engineblock</em> by default. You can</h4>

<h4 id="override-this-with-the-metrics-prefix-option">override this with the `<code>--metrics-prefix</code> option:</h4>

<pre><code>--metrics-prefix myclient.group5
</code></pre>

<h4 id="identifiers">Identifiers</h4>

<p>Metrics associated with a specific activity will have the activity alias in
their name. The names and types of metrics provided for each activity type vary.
You can easily see what metrics are available for a given activity type:</p>

<p>Sometimes, an activity type will expose metrics on a per statement basis,
measuring over all invocations of a given statement as defined in the YAML. In
these cases, you will see <code>--</code> separating the name components of the metric. The
most fully-qualified form of a named statement for metrics purposes looks like
<code>&lt;activity&gt;.&lt;docname&gt;--&lt;blockname&gt;--&lt;statementname&gt;--&lt;metricname&gt;</code>, although in
practice these will be shorter by design. Just be aware that the double dash
represents name composition <em>within</em> an activity.</p>

<pre><code>java -jar eb.jar --show-metrics alias=test type=diag
</code></pre>

<p>This initializes an activity as if to run it, but never starts cycling it.</p>

<h2 id="hdr-histograms">HDR Histograms</h2>

<h3 id="recording-hdr-histogram-logs">Recording HDR Histogram Logs</h3>

<p>You can record details of histograms from any compatible metric (histograms and
timers) with an option like this:</p>

<pre><code>--log-histograms hdrdata.log
</code></pre>

<p>If you want to record only certain metrics in this way, then use this form:</p>

<pre><code>--log-histograms 'hdrdata.log:.*suffix'
</code></pre>

<p>Notice that the option is enclosed in single quotes. This is because the second
part of the option value is a regex. The &lsquo;.*suffix&rsquo; pattern matches any metric
name that ends with &ldquo;suffix&rdquo;. Effectively, leaving out the pattern is the same
as using &lsquo;.*&rsquo;, which matches all metrics. Any valid regex is allowed here.</p>

<p>Metrics may be included in multiple logs, but care should be taken not to overdo
this. Keeping higher fidelity histogram reservoirs does come with a cost, so be
sure to be specific in what you record as much as possible.</p>

<p>If you want to specify the recording interval, use this form:</p>

<pre><code>--log-histograms 'hdrdata.log:.*suffix:5s'
</code></pre>

<p>If you want to specify the interval, you must use the third form, although it is
valid to leave the pattern empty, such as &lsquo;hdrdata.log::5s&rsquo;.</p>

<p>Each interval specified will be tracked in a discrete reservoir in memory, so they
will not interfere with each other in terms of accuracy.</p>

<h3 id="recording-hdr-histogram-stats">Recording HDR Histogram Stats</h3>

<p>You can also record basic snapshots of histogram data on a periodic interval
just like above with HDR histogram logs. The option to do this is:</p>

<pre><code>--log-histostats 'hdrstats.log:.*suffix:10s'
</code></pre>

<p>Everything works the same as for hdr histogram logging, except that the format
is in CSV as shown in the example below:</p>

<pre><code>#logging stats for session scenario-1479089852022
#[Histogram log format version 1.0]
#[StartTime: 1479089852.046 (seconds since epoch), Sun Nov 13 20:17:32 CST 2016]
#Tag,Interval_Start,Interval_Length,count,min,p25,p50,p75,p90,p95,p98,p99,p999,p9999,max
Tag=diag1.delay,0.457,0.044,1,16,31,31,31,31,31,31,31,31,31,31
Tag=diag1.cycles,0.48,0.021,31,4096,8191,8191,8191,8191,8191,8191,8191,8191,8191,2097151
Tag=diag1.delay,0.501,0.499,1,1,1,1,1,1,1,1,1,1,1,1
Tag=diag1.cycles,0.501,0.499,498,1024,2047,2047,4095,4095,4095,4095,4095,4095,4095,4194303
...
</code></pre>

<p>This includes the metric name (Tag), the interval start time and length (from
the beginning of collection time), number of metrics recorded (count), minimum
magnitude, a number of percentile measurements, and the maximum value. Notice
that the format used is similar to that of the HDR logging, although instead of
including the raw histogram data, common percentiles are recorded directly.</p>


			<aside class="copyright" role="note">
				
				&copy; 2018 APL 2.0 &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="http://docs.engineblock.io/user-guide/command_line/" title="Command Line">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Command Line
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="http://docs.engineblock.io/user-guide/timing_terms/" title="Timing Terms">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Timing Terms
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="../../javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "Â¶";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

