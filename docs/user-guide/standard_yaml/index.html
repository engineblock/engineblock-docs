<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>YAML Config - EngineBlock</title>
    <meta name="generator" content="Hugo 0.20.7" />

    
    <meta name="description" content="EngineBlock Docs">
    
    <link rel="canonical" href="http://docs.engineblock.io/user-guide/standard_yaml/">
    

    <meta property="og:url" content="http://docs.engineblock.io/user-guide/standard_yaml/">
    <meta property="og:title" content="EngineBlock">
    <meta property="og:image" content="http://docs.engineblock.io/images/engineblock_128.png">
    <meta name="apple-mobile-web-app-title" content="EngineBlock">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="http://docs.engineblock.io/images/engineblock_32.png">
    <link rel="icon" type="image/x-icon" href="http://docs.engineblock.io/images/engineblock_32.png">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('http://docs.engineblock.io/fonts/icon.eot');
        src: url('http://docs.engineblock.io/fonts/icon.eot')
               format('embedded-opentype'),
             url('http://docs.engineblock.io/fonts/icon.woff')
               format('woff'),
             url('http://docs.engineblock.io/fonts/icon.ttf')
               format('truetype'),
             url('http://docs.engineblock.io/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="http://docs.engineblock.io/stylesheets/application.css">
    <link rel="stylesheet" href="http://docs.engineblock.io/stylesheets/temporary.css">
    <link rel="stylesheet" href="http://docs.engineblock.io/stylesheets/palettes.css">
    <link rel="stylesheet" href="http://docs.engineblock.io/stylesheets/images.css">

    <link rel="stylesheet" href="http://docs.engineblock.io/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,700|Roboto&#43;Mono">
    <style>
      body, input {
        font-family: 'Roboto', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Roboto Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="http://docs.engineblock.io/javascripts/modernizr.js"></script>

    

  
    
    

    
    

    
    

    
    

    
    

    
    

    
    
    
    
    

    
    


      
    
    <link href="http://docs.engineblock.io//modules/annotatorjs/annotator.css" rel="stylesheet" />
    <script src="http://docs.engineblock.io//modules/annotatorjs/jquery-3.2.1.js"></script>
    <script src="http://docs.engineblock.io//modules/annotatorjs/annotator.js"></script>
    <script>
        var app = new annotator.App();
        app.include(annotator.ui.main);
        app
            .start()
            .then(function() {
                app.annotations.load();
            });
    </script>


  </head>
  <body class="palette-primary-grey palette-accent-teal">




<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        YAML Config
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/engineblock/engineblock" title="@engineblock/engineblock on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="http://docs.engineblock.io/" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="http://docs.engineblock.io/images/engineblock_128.png">
        </div>
      
      <div class="name">
        <strong>EngineBlock </strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="EngineBlock" href="http://docs.engineblock.io/">
	
	EngineBlock
</a>



  
</li>



<li>
  
    



<a  title="Quickstart" href="http://docs.engineblock.io/quickstart/">
	
	Quickstart
</a>



  
</li>



<li>
  
    <span class="section">User Guide</span>
    <ul>
      
        
        



<a  title="Concepts" href="http://docs.engineblock.io/user-guide/concepts/">
	
	Concepts
</a>



      
        
        



<a  title="Command Line" href="http://docs.engineblock.io/user-guide/command_line/">
	
	Command Line
</a>



      
        
        



<a  title="CLI Scripting" href="http://docs.engineblock.io/user-guide/cli_scripting/">
	
	CLI Scripting
</a>



      
        
        



<a  title="Metrics" href="http://docs.engineblock.io/user-guide/metrics/">
	
	Metrics
</a>



      
        
        



<a  title="Scenario Scripting" href="http://docs.engineblock.io/user-guide/scripting/">
	
	Scenario Scripting
</a>



      
        
        



<a class="current" title="YAML Config" href="http://docs.engineblock.io/user-guide/standard_yaml/">
	
	YAML Config
</a>


<ul id="scrollspy">
</ul>


      
    </ul>
  
</li>



<li>
  
    <span class="section">Dev Guide</span>
    <ul>
      
        
        



<a  title="Activity Internals" href="http://docs.engineblock.io/dev-guide/activity_internals/">
	
	Activity Internals
</a>



      
        
        



<a  title="Building ActivityTypes" href="http://docs.engineblock.io/dev-guide/building_activities/">
	
	Building ActivityTypes
</a>



      
        
        



<a  title="Diag ActivityType" href="http://docs.engineblock.io/dev-guide/annotated_diag/">
	
	Diag ActivityType
</a>



      
        
        



<a  title="Project Structure" href="http://docs.engineblock.io/dev-guide/contributing/">
	
	Project Structure
</a>



      
        
        



<a  title="Scripting Extensions" href="http://docs.engineblock.io/dev-guide/scripting_extensions/">
	
	Scripting Extensions
</a>



      
    </ul>
  
</li>


        </ul>
        

        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>YAML Config </h1>

			

<p>In the EB 2.* and newer versions, a standard YAML configuration format is
provided that makes it easy to use for any activity that requires statements,
tags, parameters and data bindings. In practice, any useful activity types have
needed these. This section describes the standard YAML format and how to use it.</p>

<div class="admonition note">
<p class="admonition-title"></p>
<p>For developers, a guide for using the API to read this format is in the dev guide.</p>
</div>

<p>A valid config file for an activity consists of statements, parameters for those
statements, bindings for the data to use with those statements, and tags for
selecting statements for an activity. In essence, the config format is <em>all about
configuring statements</em>. Every other element in the config format is in some way
modifying or otherwise helping create statements to be used in an activity.</p>

<h2 id="names">Names</h2>

<p>Everything in this format can have a name:</p>

<pre><code>name: test42
</code></pre>

<p>If a name is not provided, then one is automatically created. It is not important to
name things except for documentation or metric naming purposes.</p>

<h2 id="statements">Statements</h2>

<p>Statements are provided as a list. For example:</p>

<pre><code>statements:
 - &quot;This a statement.&quot;
 - &quot;The file format doesn't know how statements will be used.&quot;
 - &quot;submit job {job} on queue {queue} with options {options};&quot;
</code></pre>

<p>This is a valid yaml in and of itself. It may not be valid for a particular
activity type, but that is up to each activity type to decide. Further each
activity type determines what a statement means, and how it will be used. The
format is merely concerned with structure and very general semantics.</p>

<p>Sometimes, you want to specify the text of a statement in different ways. Since
statements are strings, the simplest way for small statements is in double
quotes as shown above. If you need to express a much longer statement with
special characters and newlines, then you can use YAML&rsquo;s literal block notation
(signaled by the &lsquo;|&rsquo; character) to do so:</p>

<pre><code>statements:
 - |
  This is a statement, and the file format doesn't
  know how statements will be used!
 - |
  submit job {alpha} on queue {beta} with options {gamma};
</code></pre>

<p>Notice that the block starts on the following line after the pipe symbol. This
is a very popular form in practice because it treats the whole block exactly as
it is shown, except for the initial indentations, which are removed.</p>

<p>Statements in this format can be raw statements, statement templates, or
anything that is appropriate for the specific activity type they are being used
with. Generally, the statements should be thought of as a statement form that
you want to use in your activity &ndash; something that has place holders for data
bindings. These place holders are called <em>named anchors</em>. The second line above
is an example of a statement template, with anchors that can be replaced by
data for each cycle of an activity.</p>

<h2 id="bindings">Bindings</h2>

<p>Procedural data generation is now built-in to the EngineBlock runtime by way of
the <a href="http://virtdata.io/">Virtual DataSet</a> library. Thus, bindings are now
supported as a core concept. You can add a bindings section like this:</p>

<pre><code>bindings:
 alpha: Identity()
 beta: NumberNameToString()
 gamma: Combinations('0-9A-F;0-9;A-Z;_;p;r;o;')
 delta: WeightedStrings(one:1;six:6;three:3;)
</code></pre>

<p>Notice that bindings are represented as a map. The bindings above <em>mostly</em> match
up with the named anchors in the statement list above. There is one extra
binding, but this is ok. If a binding were named in the statement that was not
defined, an error would occur.</p>

<div class="admonition note">
<p class="admonition-title"></p>
<p>This is important for activity type designers to observe: When statement bindings
are paired with statements, a binding should not be used directly unless it is
paired with a matching anchor name in the statement. This allows activity and
scenario designers to keep a library of data binding recipes in their
configurations without incurring the cost of extraneous binding evaluations.</p>
</div>

<p>Still, the above statement block is a valid config file. It may or may not be
valid for a given activity type. The &lsquo;stdout&rsquo; activity will synthesize a
statement template from the provided bindings if needed, so this is valid:</p>

<pre><code>[test]$ cat &gt; stdout-test.yaml
    bindings:
     alpha: Identity()
     beta: NumberNameToString()
     gamma: Combinations('0-9A-F;0-9;A-Z;_;p;r;o;')
     delta: WeightedStrings(one:1;six:6;three:3;)

[test]$ ./eb run type=stdout yaml=stdout-test cycles=10
0,zero,00A_pro,six
1,one,00B_pro,six
2,two,00C_pro,three
3,three,00D_pro,three
4,four,00E_pro,six
5,five,00F_pro,six
6,six,00G_pro,six
7,seven,00H_pro,six
8,eight,00I_pro,six
9,nine,00J_pro,six
</code></pre>

<p>If you combine the statement section and the bindings sections above into one
activity yaml, you get a slightly different result, as the bindings apply
to the statements that are provided:</p>

<pre><code>[test]$ cat &gt; stdout-test.yaml
statements:
 - |
  This is a statement, and the file format doesn't
  know how statements will be used!
 - |
  submit job {alpha} on queue {beta} with options {gamma};
bindings:
 alpha: Identity()
 beta: NumberNameToString()
 gamma: Combinations('0-9A-F;0-9;A-Z;_;p;r;o;')
 delta: WeightedStrings(one:1;six:6;three:3;)

[test]$ ./eb run type=stdout yaml=stdout-test cycles=10
This is a statement, and the file format doesn't
know how statements will be used!
submit job 1 on queue one with options 00B_pro;
This is a statement, and the file format doesn't
know how statements will be used!
submit job 3 on queue three with options 00D_pro;
This is a statement, and the file format doesn't
know how statements will be used!
submit job 5 on queue five with options 00F_pro;
This is a statement, and the file format doesn't
know how statements will be used!
submit job 7 on queue seven with options 00H_pro;
This is a statement, and the file format doesn't
know how statements will be used!
submit job 9 on queue nine with options 00J_pro;
</code></pre>

<p>There are a few things to notice here. First, the statements that are executed
are automatically alternated between. If you had 10 different statements listed,
they would all get their turn with 10 cycles. Since there were two, each was run
5 times.</p>

<p>Also, the statement that had named anchors acted as a template, whereas the
other one was evaluated just as it was. In fact, they were both treated as
templates, but one of the had no anchors.</p>

<p>On more minor but important detail is that the fourth binding <em>delta</em> was not
referenced directly in the statements. Since the statements did not pair up an
anchor with this binding name, it was not used. No values were generated. This
is how activities are expected to work when they are implemented correctly. This
means that the bindings themselves are templates for data generation, only to be
used when necessary.</p>

<h2 id="params">Params</h2>

<p>As with the bindings, a params section can be added at the same level, providing
additional parameters to be used with all the statements provided. Again, this
is an example of modifying or otherwise creating a specific type of statement, but
always in a way specific to the activity type. As such, params don&rsquo;t really do
much on their own, although they have the same basic map syntax as bindings:</p>

<pre><code>params:
 ratio: 1
</code></pre>

<h2 id="tags">Tags</h2>

<p>Tags are used to mark and filter groups of statements for controlling different
types of scenario execution.</p>

<pre><code>tags:
 name:foxtrot
statements:
 - &quot;I'm alive!&quot;
</code></pre>

<h3 id="tag-filtering">Tag Filtering</h3>

<p>The tag filters provide a flexible set of conventions for filtering tagged statements.
Tag filters are usually provided as an activity parameter when an activity is launched.
The rules for tag filtering are:</p>

<ol>
<li>If no tag filter is specified, then the statement matches.</li>
<li>A tag name predicate like <code>tags=name</code> asserts the presence of a specific
tag name, regardless of its value.</li>
<li>A tag value predicate like <code>tags=name:foxtrot</code>asserts the presence of
a specific tag name and a specific value for it.</li>
<li>A tag pattern predicate like <code>tags=&lsquo;nam.*&rsquo;</code> asserts the presence of a
specific tag name and a value that matches the provided regular expression.</li>
<li>Tag predicates are joined by <em>and</em> when more than one is provided &ndash; If any predicate
fails to match a tagged element, then the whole tag filtering expression fails
to match.</li>
</ol>

<p>A demonstration&hellip;</p>

<pre><code>[test]$ cat &gt; stdout-test.yaml
tags:
 name: foxtrot
statements:
 - &quot;I'm alive!\n&quot;

# no tag filter matches any
[test]$ ./eb run type=stdout yaml=stdout-test
I'm alive!

# tag name assertion matches
[test]$ ./eb run type=stdout yaml=stdout-test tags=name
I'm alive!

# tag name assertion does not match
[test]$ ./eb run type=stdout yaml=stdout-test tags=name2
02:25:28.158 [scenarios:001] ERROR i.e.activities.stdout.StdoutActivity - Unable to create a stdout statement if you have no active statements or bindings configured.

# tag value assertion does not match
[test]$ ./eb run type=stdout yaml=stdout-test tags=name:bravo
02:25:42.584 [scenarios:001] ERROR i.e.activities.stdout.StdoutActivity - Unable to create a stdout statement if you have no active statements or bindings configured.

#tag value assertion matches
[test]$ ./eb run type=stdout yaml=stdout-test tags=name:foxtrot
I'm alive!

# tag pattern assertion matches
[test]$ ./eb run type=stdout yaml=stdout-test tags=name:'fox.*'
I'm alive!

#tag pattern assertion does not match
[test]$ ./eb run type=stdout yaml=stdout-test tags=name:'tango.*'
02:26:05.149 [scenarios:001] ERROR i.e.activities.stdout.StdoutActivity - Unable to create a stdout statement if you have no active statements or bindings configured.
</code></pre>

<h2 id="blocks">Blocks</h2>

<p>All the basic primitives describe above (names, statements, bindings, params, tags) can be used
to describe and parameterize a set of statements in a yaml document. Sometimes you need to
structure your statements in a more sophisticated way. You might want to do this if you have
a set of common statement forms or parameters that need to apply to many statements, or perhaps
if you have several <em>different</em> groups of statements that need to be configured independently.</p>

<p>This is where blocks become useful:</p>

<pre><code>[test]$ cat &gt; stdout-test.yaml
bindings:
 alpha: Identity()
 beta: Combinations('u;n;u;s;e;d;')
blocks:
 - statements:
   - &quot;{alpha},{beta}\n&quot;
   bindings:
    beta: Combinations('b;l;o;c;k;1;-;COMBINATIONS;')
 - statements:
   - &quot;{alpha},{beta}\n&quot;
   bindings:
    beta: Combinations('b;l;o;c;k;2;-;COMBINATIONS;')

[test]$ ./eb run type=stdout yaml=stdout-test cycles=10
0,block1-C
1,block2-O
2,block1-M
3,block2-B
4,block1-I
5,block2-N
6,block1-A
7,block2-T
8,block1-I
9,block2-O
</code></pre>

<p>This shows a couple of important features of blocks. All blocks inherit defaults
for bindings, params, and tags from the root document level. Any of these values
that are defined at the base document level apply to all blocks contained in
that document, unless specifically overridden within a given block.</p>

<h2 id="multi-docs">Multi-Docs</h2>

<p>The YAML spec allows for multiple yaml documents to be concatenated in the
same file with a separator:</p>

<hr />

<p>This offers an additional convenience when configuring activities. If you want
to parameterize or tag some a set of statements with their own bindings, params,
or tags, but alongside another set of uniquely configured statements, you need
only put them in separate logical documents, separated by a triple-dash.
For example:</p>

<pre><code>[test]$ cat &gt; stdout-test.yaml
bindings:
 docval: WeightedStrings('doc1.1:1;doc1.2:2;')
statements:
 - &quot;doc1.form1 {docval}\n&quot;
 - &quot;doc1.form2 {docval}\n&quot;
---
bindings:
 numname: NumberNameToString()
statements:
 - &quot;doc2.number {numname}\n&quot;

[test]$ ./eb run type=stdout yaml=stdout-test cycles=10
doc1.form1 doc1.1
doc1.form2 doc1.2
doc2.number two
doc1.form1 doc1.2
doc1.form2 doc1.1
doc2.number five
doc1.form1 doc1.2
doc1.form2 doc1.2
doc2.number eight
doc1.form1 doc1.1
</code></pre>

<h2 id="template-params">Template Params</h2>

<p>All EngineBlock YAML formats support a parameter macro format that applies before
YAML processing starts. It is a basic macro facility that allows named
anchors to be placed in the document as a whole:</p>

<pre><code>&lt;&lt;varname:defaultval&gt;&gt;
</code></pre>

<p>In this example, the name of the parameter is <code>varname</code>. It is given a default
value of <code>defaultval</code>. If an activity parameter named <em>varname</em> is provided, as
in <code>varname=barbaz</code>, then this whole expression including the double angle
brackets will be replaced with <code>barbaz</code>. If none is provided then the default
value. For example:</p>

<pre><code>[test]$ cat &gt; stdout-test.yaml
statements:
 - &quot;&lt;&lt;linetoprint:MISSING&gt;&gt;\n&quot;

[test]$ ./eb run type=stdout yaml=stdout-test cycles=1
MISSING

[test]$ ./eb run type=stdout yaml=stdout-test cycles=1 linetoprint=&quot;THIS IS IT&quot;
THIS IS IT
</code></pre>


			<aside class="copyright" role="note">
				
				&copy; 2017 APL 2.0 &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="http://docs.engineblock.io/user-guide/scripting/" title="Scenario Scripting">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Scenario Scripting
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="http://docs.engineblock.io/user-guide/command_line/" title="Command Line">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Command Line
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="http://docs.engineblock.io/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "¶";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

