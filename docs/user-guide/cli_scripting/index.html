<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>CLI Scripting - EngineBlock</title>
    <meta name="generator" content="Hugo 0.20.7" />

    
    <meta name="description" content="EngineBlock Docs">
    
    <link rel="canonical" href="http://docs.engineblock.io/user-guide/cli_scripting/">
    

    <meta property="og:url" content="http://docs.engineblock.io/user-guide/cli_scripting/">
    <meta property="og:title" content="EngineBlock">
    <meta property="og:image" content="http://docs.engineblock.io/images/engineblock_128.png">
    <meta name="apple-mobile-web-app-title" content="EngineBlock">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="http://docs.engineblock.io/images/engineblock_32.png">
    <link rel="icon" type="image/x-icon" href="http://docs.engineblock.io/images/engineblock_32.png">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('http://docs.engineblock.io/fonts/icon.eot');
        src: url('http://docs.engineblock.io/fonts/icon.eot')
               format('embedded-opentype'),
             url('http://docs.engineblock.io/fonts/icon.woff')
               format('woff'),
             url('http://docs.engineblock.io/fonts/icon.ttf')
               format('truetype'),
             url('http://docs.engineblock.io/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="http://docs.engineblock.io/stylesheets/application.css">
    <link rel="stylesheet" href="http://docs.engineblock.io/stylesheets/temporary.css">
    <link rel="stylesheet" href="http://docs.engineblock.io/stylesheets/palettes.css">
    <link rel="stylesheet" href="http://docs.engineblock.io/stylesheets/images.css">

    <link rel="stylesheet" href="http://docs.engineblock.io/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,700|Roboto&#43;Mono">
    <style>
      body, input {
        font-family: 'Roboto', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Roboto Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="http://docs.engineblock.io/javascripts/modernizr.js"></script>

    

  
    
    

    
    

    
    

    
    

    
    

    
    

    
    
    
    
    

    
    


      
    
    <link href="http://docs.engineblock.io//modules/annotatorjs/annotator.css" rel="stylesheet" />
    <script src="http://docs.engineblock.io//modules/annotatorjs/jquery-3.2.1.js"></script>
    <script src="http://docs.engineblock.io//modules/annotatorjs/annotator.js"></script>
    <script>
        var app = new annotator.App();
        app.include(annotator.ui.main);
        app
            .start()
            .then(function() {
                app.annotations.load();
            });
    </script>


  </head>
  <body class="palette-primary-grey palette-accent-teal">




<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        CLI Scripting
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/engineblock/engineblock" title="@engineblock/engineblock on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="http://docs.engineblock.io/" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="http://docs.engineblock.io/images/engineblock_128.png">
        </div>
      
      <div class="name">
        <strong>EngineBlock </strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="EngineBlock" href="http://docs.engineblock.io/">
	
	EngineBlock
</a>



  
</li>



<li>
  
    



<a  title="Quickstart" href="http://docs.engineblock.io/quickstart/">
	
	Quickstart
</a>



  
</li>



<li>
  
    <span class="section">User Guide</span>
    <ul>
      
        
        



<a  title="Concepts" href="http://docs.engineblock.io/user-guide/concepts/">
	
	Concepts
</a>



      
        
        



<a  title="Command Line" href="http://docs.engineblock.io/user-guide/command_line/">
	
	Command Line
</a>



      
        
        



<a class="current" title="CLI Scripting" href="http://docs.engineblock.io/user-guide/cli_scripting/">
	
	CLI Scripting
</a>


<ul id="scrollspy">
</ul>


      
        
        



<a  title="Metrics" href="http://docs.engineblock.io/user-guide/metrics/">
	
	Metrics
</a>



      
        
        



<a  title="Scenario Scripting" href="http://docs.engineblock.io/user-guide/scripting/">
	
	Scenario Scripting
</a>



      
    </ul>
  
</li>



<li>
  
    <span class="section">Dev Guide</span>
    <ul>
      
        
        



<a  title="Activity Internals" href="http://docs.engineblock.io/dev-guide/activity_internals/">
	
	Activity Internals
</a>



      
        
        



<a  title="Building ActivityTypes" href="http://docs.engineblock.io/dev-guide/building_activities/">
	
	Building ActivityTypes
</a>



      
        
        



<a  title="Diag ActivityType" href="http://docs.engineblock.io/dev-guide/annotated_diag/">
	
	Diag ActivityType
</a>



      
        
        



<a  title="Project Structure" href="http://docs.engineblock.io/dev-guide/contributing/">
	
	Project Structure
</a>



      
        
        



<a  title="Scripting Extensions" href="http://docs.engineblock.io/dev-guide/scripting_extensions/">
	
	Scripting Extensions
</a>



      
    </ul>
  
</li>


        </ul>
        

        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>CLI Scripting </h1>

			

<p>Sometimes you want to to run a set of workloads in a particular order, or call other specific test setup logic in between phases or workloads. While the full scripting environment allows you to do this and more, it is not necessary to write javascript for every scenario.</p>

<p>For more basic setup and sequencing needs, you can achive a fair degree of flexibility on the command line. A few key API calls are supported directly on the command line. This guide explains each of them, what the do, and how to use them together.</p>

<h2 id="script-construction">Script Construction</h2>

<p>As the command line is parsed, from left to right, the scenario script is built in an internal scripting buffer. Once the command line is fully parsed, this script is executed. Each of the commands below is effectively a macro for a snippet of script. It is important to remember that order is important.</p>

<h2 id="command-line-format">Command line format</h2>

<p>Newlines are not allowed when building scripts from the command line. As long as you follow the allowed forms below, you can simply string multiple commands together with spaces between. As usual, single word options without double dashes are commands, key=value style parameters apply to the previous command, and all other commands with &ndash;this-style are non-scripting options.</p>

<h2 id="concurrency-control">Concurrency &amp; Control</h2>

<p>All activities that run during a scenario run under the control of, but independently from the scenario script. This means that you can have a number of activities running while the scenario script is doing its own thing. The scenario only completes when both the scenario script and the activities are finished.</p>

<h3 id="start-type-lt-activity-type-gt-alias-lt-alias-gt">start type=&lt;activity type&gt; alias=&lt;alias&gt; &hellip;</h3>

<p>You can start an activity with this command. At the time this command is evaluated, the activity is started, and the script continues without blocking. This is an asynchronous start of an activity. If you start multiple activities in this way, they will run concurrently.</p>

<p>The type argument is required to identify the activity type to run. The alias parameter is not strictly required, unless you want to be able to interact with the started activity later. In any case, it is a good idea to name all your activities with a meaningful alias.</p>

<h3 id="stop-lt-alias-gt">stop &lt;alias&gt;</h3>

<p>Stop an activity with the given alias. This is synchronous, and causes the scenario to pause until the activity is stopped. This means that all threads for the activity have completed and signalled that they&rsquo;re in a stopped state.</p>

<h3 id="await-lt-alias-gt">await &lt;alias&gt;</h3>

<p>Await the normal completion of an activity with the given alias. This causes the scenario script to pause while it waits for the named activity to finish. This does not tell the activity to stop. It simply puts the scenario script into a paused state until the named activity is complete.</p>

<h3 id="run-type-lt-activity-type-gt-alias-lt-alias-gt">run type=&lt;activity type&gt; alias=&lt;alias&gt; &hellip;</h3>

<p>Run an activity to completion, waiting until it is complete before continuing with the scenario script.
It is effectively the same as <strong>start type=&lt;activity type&gt; &hellip; alias&lt;alias&gt; await &lt;alias&gt;</strong></p>

<h3 id="waitmillis-lt-milliseconds-gt">waitmillis &lt;milliseconds&gt;</h3>

<p>Pause the scenario script for this many milliseconds. This is useful for controlling workload run duration, etc.</p>

<h3 id="script-lt-script-file-gt">script &lt;script file&gt;</h3>

<p>Add the contents of the named file to the script buffer.</p>

<h1 id="an-example-cli-script">An example CLI script</h1>

<pre><code>./run-eb \
start type=diag alias=activity_one cycles=10000000 \
start type=diag alias=activity_two cycles=20000000 \
waitmillis 10000 \
await activity_one \
stop activity_two
</code></pre>

<p>in this CLI script, the backslashes are necessary in order keep everything on the same command line. Here is a narrative of what happens when it is run.</p>

<ol>
<li>An activity named &lsquo;activity_one&rsquo; is started, with 1 million cycles of work.</li>
<li>An activity named &lsquo;activity_two&rsquo; is started, with 2 million cycles of work.</li>
<li>While these activities run, the scenario script waits for ten seconds.</li>
<li>If activity_one is complete, the await returns immediately. If not, the script waits for activity_one to complete its 1000000 cycles.</li>
<li>activity_two is immediately stopped.</li>
<li>Because all activities are stopped or complete, and the script is complete, the scenario exits.</li>
</ol>


			<aside class="copyright" role="note">
				
				&copy; 2017 APL 2.0 &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="http://docs.engineblock.io/dev-guide/building_activities/" title="Building ActivityTypes">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Building ActivityTypes
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="http://docs.engineblock.io/dev-guide/annotated_diag/" title="Diag ActivityType">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Diag ActivityType
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="http://docs.engineblock.io/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "¶";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

