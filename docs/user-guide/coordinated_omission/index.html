<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Coordinated Omission - EngineBlock</title>
    <meta name="generator" content="Hugo 0.46" />

    
    <meta name="description" content="EngineBlock Docs">
    
    <link rel="canonical" href="http://docs.engineblock.io/user-guide/coordinated_omission/">
    

    <meta property="og:url" content="http://docs.engineblock.io/user-guide/coordinated_omission/">
    <meta property="og:title" content="EngineBlock">
    <meta property="og:image" content="/images/engineblock_128.png">
    <meta name="apple-mobile-web-app-title" content="EngineBlock">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="../../images/engineblock_32.png">
    <link rel="icon" type="image/x-icon" href="../../images/engineblock_32.png">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('/fonts/icon.eot?52m981');
        src: url('/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
             url('/fonts/icon.woff?52m981')
               format('woff'),
             url('/fonts/icon.ttf?52m981')
               format('truetype'),
             url('/fonts/icon.svg?52m981#icon')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="../../stylesheets/application.css">
    <link rel="stylesheet" href="../../stylesheets/temporary.css">
    <link rel="stylesheet" href="../../stylesheets/palettes.css">
    <link rel="stylesheet" href="../../stylesheets/images.css">

    <link rel="stylesheet" href="../../stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,700|Roboto&#43;Mono">
    <style>
      body, input {
        font-family: 'Roboto', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Roboto Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="../../javascripts/modernizr.js"></script>

    

  

    
    

    
    

    
    

    
    
    <script src="http://docs.engineblock.io//modules/jssequence/webfont.js"></script>
    <script src="http://docs.engineblock.io//modules/jssequence/snap.svg-min.js"></script>
    <script src="http://docs.engineblock.io//modules/jssequence/underscore-min.js"></script>
    <script src="http://docs.engineblock.io//modules/jssequence/sequence-diagram.js"></script>
    <link href="http://docs.engineblock.io//modules/jssequence/sequence-diagram-min.css" rel="stylesheet" />
    

    
    
    <script src="http://docs.engineblock.io//modules/railroad/railroad-diagrams.js"></script>
    <link href="http://docs.engineblock.io//modules/railroad/railroad-diagrams.css" rel="stylesheet">
    

    
    
    <link href="http://docs.engineblock.io//modules/jsxgraph/jsxgraph.css" type="text/css" rel="stylesheet"/>
    <script src="http://docs.engineblock.io//modules/jsxgraph//jsxgraphcore.js"></script>
    
    

    
    
    <link href="http://docs.engineblock.io//modules/mermaid/mermaid.css" type="text/css" rel="stylesheet"/>
    <script src="http://docs.engineblock.io//modules/mermaid/mermaid.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    

    
    
    <script src="http://docs.engineblock.io//modules/nomnoml/lodash.min.js"></script>
    <script src="http://docs.engineblock.io//modules/nomnoml/dagre.min.js"></script>
    <script src="http://docs.engineblock.io//modules/nomnoml/skanaar.util.js"></script>
    <script src="http://docs.engineblock.io//modules/nomnoml/skanaar.svg.js"></script>
    <script src="http://docs.engineblock.io//modules/nomnoml/skanaar.vector.js"></script>
    <script src="http://docs.engineblock.io//modules/nomnoml/skanaar.canvas.js"></script>
    <script src="http://docs.engineblock.io//modules/nomnoml/nomnoml.jison.js"></script>
    <script src="http://docs.engineblock.io//modules/nomnoml/nomnoml.parser.js"></script>
    <script src="http://docs.engineblock.io//modules/nomnoml/nomnoml.layouter.js"></script>
    <script src="http://docs.engineblock.io//modules/nomnoml/nomnoml.renderer.js"></script>
    <script src="http://docs.engineblock.io//modules/nomnoml/nomnoml.js"></script>
    

    
    

    
    


  </head>
  <body class="palette-primary-grey palette-accent-teal">




<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Coordinated Omission
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/engineblock/engineblock" title="@engineblock/engineblock on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="http://docs.engineblock.io/" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="http://docs.engineblock.io/images/engineblock_128.png">
        </div>
      
      <div class="name">
        <strong>EngineBlock </strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="EngineBlock" href="../../">
	
	EngineBlock
</a>





  
</li>



<li>
  
    



<a  title="Quickstart" href="../../quickstart/">
	
	Quickstart
</a>





  
</li>



<li>
  
    <span class="section">User Guide</span>
    <ul>
      
        
        



<a  title="Concepts" href="../../user-guide/concepts/">
	
	Concepts
</a>





      
        
        



<a  title="Command Line" href="../../user-guide/command_line/">
	
	Command Line
</a>





      
        
        



<a  title="CLI Scripting" href="../../user-guide/cli_scripting/">
	
	CLI Scripting
</a>





      
        
        



<a  title="YAML Config" href="../../user-guide/standard_yaml/">
	
	YAML Config
</a>





      
        
        



<a  title="Timing Terms" href="../../user-guide/timing_terms/">
	
	Timing Terms
</a>





      
        
        



<a  title="Using Metrics" href="../../user-guide/using_metrics/">
	
	Using Metrics
</a>





      
        
        



<a  title="Standard Metrics" href="../../user-guide/standard_metrics/">
	
	Standard Metrics
</a>





      
        
        



<a  title="Coordinated Omission" href="../../user-guide/coordinated_omission/">
	
	Coordinated Omission
</a>





      
        
        



<a  title="Scenario Scripting" href="../../user-guide/scenario_scripting/">
	
	Scenario Scripting
</a>





      
    </ul>
  
</li>



<li>
  
    <span class="section">Parameters</span>
    <ul>
      
        
        



<a  title="Parameter Usage" href="../../parameters/parameter_usage/">
	
	Parameter Usage
</a>





      
        
        



<a  title="Example Command" href="../../parameters/example_command/">
	
	Example Command
</a>





      
        
        



<a  title="Activity Params" href="../../parameters/activity_params/">
	
	Activity Params
</a>





      
        
        



<a  title="Statement Params" href="../../parameters/statement_params/">
	
	Statement Params
</a>





      
    </ul>
  
</li>



<li>
  
    <span class="section">Dev Guide</span>
    <ul>
      
        
        



<a  title="Activity Internals" href="../../dev-guide/activity_internals/">
	
	Activity Internals
</a>





      
        
        



<a  title="Async Operations" href="../../dev-guide/async_operations/">
	
	Async Operations
</a>





      
        
        



<a  title="Building ActivityTypes" href="../../dev-guide/building_activities/">
	
	Building ActivityTypes
</a>





      
        
        



<a  title="Contributing" href="../../dev-guide/contributing/">
	
	Contributing
</a>





      
        
        



<a  title="Design Guidelines" href="../../dev-guide/implementors_guide/">
	
	Design Guidelines
</a>





      
        
        



<a  title="Diag ActivityType" href="../../dev-guide/annotated_diag/">
	
	Diag ActivityType
</a>





      
        
        



<a  title="Project Structure" href="../../dev-guide/project_structure/">
	
	Project Structure
</a>





      
        
        



<a  title="Scripting Extensions" href="../../dev-guide/scripting_extensions/">
	
	Scripting Extensions
</a>





      
        
        



<a  title="Error Mapping" href="../../dev-guide/error_mapping/">
	
	Error Mapping
</a>





      
        
        



<a  title="YAML Config API" href="../../dev-guide/standard_yam_devl/">
	
	YAML Config API
</a>





      
    </ul>
  
</li>


        </ul>
        

        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Coordinated Omission </h1>

			

<p>Coordinated omission is a term of art coined by Gil Tene. In practice,
coordinated omission follows from the fact that all systems have finite
concurrency and scheduling capacity, including the clients that test them. While
the term doesn&rsquo;t cover all important aspects of scale and performance testing,
it does put a focus on a particularly troublesome problem that often occurs with
testing methods where effective concurrency is a meaningful limitation.</p>

<p>Scheduling constraints are pervasive in distributed systems. <em>Coordinated Omission</em>
is simply a focal point from the much broader topic
<a href="https://en.wikipedia.org/wiki/Queueing_theory">Queueing Theory</a>.
Still, it is appropriate to focus on the coordinated omission scenario as an object
lesson. It can provide common ground for discussion and understanding of more common
operational goals, without requiring that users do a costly bulk-import of other
theory.</p>

<p>EngineBlock has specific features to help shed a light on the effects of
coordinated omission. This section explains some of them, how they work, and how
to use them.</p>

<p>To make sense of this, it is important to be aware of the specific meaning
of the terms used for timing with systems testing. For a specific view on
how timing terms are used with EngineBlock, see <a href="../timing_terms">timing terms</a>.</p>

<p>As EngineBlock is a client-side tool, only the first two are directly
observable: <em>wait time</em> and <em>latency</em>. The most important, <em>response</em> is
calculated separately per operation. The reason for this will be made clearer below.</p>

<h2 id="coordinated-omission-and-async-clients">Coordinated Omission and Async Clients</h2>

<p>The effects of coordinated omission can happen with synchronous as well as asynchronous
clients and servers. This follows from a maxim: All systems have finite capacity.
It is true that asynchronous clients can usually manage higher concurrency with lower
operational cost. This is not the same as saying async clients avoid problems with
coordinated omission suffered by synchronous clients. This is simply not true, and
in practice is simply a matter of moving the measurement of scheduling constraints
to a different limiting resource. The idea that asynchronous clients may somehow
avoid these issues is based a common fallacy: Async clients that are practical do not
generally delegate <em>all</em> responsibility for a message to external systems. This is
not practical, as every pending operation needs to be tracked by a client at some
level in order to ensure robustness in behavior. For example, such a client would
have no definition of a timeout, and this is not practical in robust system design.
Thus, no asynchronous mechanism that is robust can totally offload work to the
surrounding system, and thus must have a finite capacity. For asynchronous clients
this tends to manifest in internal work queues and timers as well as in-memory
state associated with pending requests.</p>

<p>To be clear, asynchronous clients can&rsquo;t avoid coordinated omission. They may simply
defer it to another level of activity, but it is still there when scheduling constraints
occur.</p>

<h2 id="c-o-rate-controls">C.O. Rate Controls</h2>

<p>When rate limiting is enabled, the rate limiter is responsible for both limiting
the start time of each operation as well as tracking how far the operations lag
behind the ideal schedule.</p>

<h3 id="in-current-engineblock-versions">In Current EngineBlock versions</h3>

<p>In the current version of EngineBlock, this is retained as a scheduling delay specific to
each operation and added to any measurements of latency in order to arrive at an
overall response time for each operation. The phrase <em>scheduling delay</em> here
is a specific form of wait time that is imposed upon the client in order to simulate
some consistent rate of ideal users in the system, with operations spread over time.</p>

<p>When the rate controls are enabled, you have to decide whether the scheduling
delay measured by the rate limiter will be used in response time metrics or not. If
you choose not to include the delay, then the response time metrics only
measure latency. You can still observe the scheduling delay metric
in this case, as it is tracked and reported separately.
If you choose to include the delay, then latency metrics reported are effectively
promoted to <em>response time</em> metrics.</p>

<p>In the EngineBlock documentation, metrics which can have this adjustment made
are called <strong><em>coordinated omission aware</em></strong>. In general, any where you see a
configuration option with <code>co</code> in it, this represent the option of enabling a
total response metric that is coordinated omission aware, or converting a
latency metric to a response metric.</p>

<p>There are reasons to measure either way, depending on the kind of testing you
are doing. All systems have concurrency limitations and critical resource
constraints. Also, systems are comprised of clients <em>and</em> servers with various
concurrency models. Sometimes it is useful to see system behavior through a more
conventional lens.</p>

<h3 id="in-future-engineblock-versions">In Future EngineBlock versions</h3>

<p>The metrics for latency, wait time, and response time will all be calculated
consistently. Only latency will be provided as a standard metric, but when
rate limiting is enabled, additional metrics for wait time and response time
will be provided.</p>

<h2 id="using-c-o-metrics">Using C.O. metrics</h2>

<p>You can enable coordinated awareness in your metrics by using the following activity parameters:</p>

<ul>
<li><a href="../../parameters/activity_params/#striderate">striderate</a></li>
<li><a href="../../parameters/activity_params/#cyclerate">cyclerate</a></li>
<li><a href="../../parameters/activity_params/#phaserate">phaserate</a></li>
</ul>

<p>These rate controls nest from the outside-in. The relationship between them is explained
in more detail under <a href="../../parameters/activity_params">Activity Params</a>.</p>

<p>Setting a target rate for more than one of these at a time is not something that is
generally useful, since nested rates can become askew from each other unless they are
perfectly matched together in terms of counts and rates.</p>

<p>In general, simply add <code>,co</code> to the end of any rate specifier to ensure that it is enabled.
For example, <code>cyclerate=1000,0.0,co</code>. The second number in the rate specifier will be
a scheduling strictness control. For now, it is required to be <code>0.0</code>, which means burstable
average rate limiting. Still, the scheduling delay is included in the result as long as <code>,co</code>
is present. Alternately, you can use the <code>co_</code> prefix for the rate controls to achieve
the same effect, as in <code>co_cyclerate=1000</code>.</p>

<h2 id="metric-names">Metric Names</h2>

<p>When a rate limiter is set, the <a href="../../user-guide/standard_metrics/#cycles">cycles</a>
metric is becomes a total response time metric instead of simply an operational
latency metric. If you have an activity named &ldquo;myactivity&rdquo; by the
<code>alias=myactivity</code> parameter, then this metric will be named
<code>&lt;prefix&gt;.myactivity.cycles</code>, where the prefix is set by the metrics prefix
option. The same apples for the stride and phase metrics, using the same
conventions.</p>

<p>Additionally, there are two additional metrics that are reported for rate limiters:</p>

<ul>
<li><code>&lt;alias&gt;.&lt;stride|cycle|phase&gt;.cco_delay_gauge</code> - A meter of the cumulative
scheduling delay for an activity with the alias and the respective rate limiter
level. Although this is a gauge, the scheduled delay that is added to latencies is calculated
per-op.

<ul>
<li>example: <code>testactivity.cycle.cco_delay_gauge</code> is the cycle delay gauge for an activity with the alias
&lsquo;testactivity&rsquo;.</li>
</ul></li>
<li><code>&lt;alias&gt;.&lt;stride|cycle|phase&gt;.avg_targetrate_gauge</code> - This simply reports the intended average
target rate for complete metric views in dashboards.
<br /></li>
</ul>

<h2 id="concurrency-model">Concurrency Model</h2>

<p>Activity types can implement either a per-thread concurrency model or an asynchronous concurrency
model which allows threads to manage a number of simultaneous requests each. In practice, this can
be a factor for how many pending requests a client can put into flight. Async implementations generally
have the ability to juggle a higher number of pending operations, as idle time on threads is reduced
as well as context switching that occurs when high thread counts are used to drive effective concurrency.</p>

<p>However, even asynchronous implementations have limits as to where blocking states can occur. Regardless
of whether your client-server system is synchronous or asynchronous, there will be a limitation of
how much work can be enqueued without going into a backlogging mode somewhere in the flow. It is
important to bear this in mind when interpreting coordinated omission results, as there is no simple
and universal remedy for resource contention at saturation. If you are not driving a saturating load
to the target system, and you are not blocking your client or server op rates by hitting
concurrency limits, then there is little difference between the two concurrency models in terms of
measurement.</p>

<p>In effect, the coordinated omission awareness and the ability to have an asynchronous execution model
should be considered complimentary. If you want to use async activities, and the activity type supports
asynchronous operations, then you can enable it separately. Going forward, the convention for enabling
async on an activity that supports it will be the <code>async</code> parameter, which will be documented
in the respective activity type documentation.</p>


			<aside class="copyright" role="note">
				
				&copy; 2018 APL 2.0 &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="http://docs.engineblock.io/user-guide/scenario_scripting/" title="Scenario Scripting">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Scenario Scripting
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="http://docs.engineblock.io/user-guide/concepts/" title="Concepts">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Concepts
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="../../javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "¶";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

